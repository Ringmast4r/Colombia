<!DOCTYPE html>
<html>
<head>
    <title>VIOLENCE STATISTICS - COLOMBIA (2016-2025)</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body { margin: 0; padding: 0; font-family: Arial, sans-serif; }
        #map { position: absolute; top: 70px; bottom: 0; width: 100%; }
        .header {
            position: absolute; top: 0; left: 0; right: 0; height: 70px;
            background: linear-gradient(135deg, #8B0000 0%, #4a0000 100%);
            color: #fff; display: flex; align-items: center; padding: 0 20px; z-index: 1000;
        }
        .header h1 { margin: 0; font-size: 22px; }
        .header .subtitle { margin-left: 20px; font-size: 14px; color: #ffcccc; }
        .legend {
            position: absolute; bottom: 30px; left: 10px;
            background: rgba(255,255,255,0.95); padding: 15px;
            border-radius: 8px; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .legend h4 { margin: 0 0 10px 0; font-size: 14px; color: #333; }
        .legend-item { display: flex; align-items: center; margin: 5px 0; font-size: 12px; }
        .legend-color { width: 16px; height: 16px; margin-right: 8px; border-radius: 50%; border: 2px solid #333; }
        .info-panel {
            position: absolute; top: 80px; right: 10px;
            background: rgba(0,0,0,0.9); color: #fff; padding: 15px;
            border-radius: 8px; z-index: 1000; max-width: 300px; font-size: 12px;
        }
        .info-panel h4 { margin: 0 0 10px 0; color: #ff6b6b; }
        .stats-box {
            background: rgba(139,0,0,0.3); padding: 10px; border-radius: 5px;
            margin: 10px 0; border-left: 3px solid #ff0000;
        }
        .loading {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8); color: #fff; padding: 30px;
            border-radius: 10px; z-index: 2000; text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>VIOLENCE STATISTICS - COLOMBIA</h1>
        <span class="subtitle">Homicides & Massacres | 2016-2025 | ergit.presidencia.gov.co</span>
    </div>
    <div id="map"></div>
    <div class="legend">
        <h4>Violence Types</h4>
        <div class="legend-item"><div class="legend-color" style="background:#FF0000"></div>Homicides - Peace Signatories (432)</div>
        <div class="legend-item"><div class="legend-color" style="background:#FF8C00"></div>Homicides - DDH Defensoria (748)</div>
        <div class="legend-item"><div class="legend-color" style="background:#FFD700"></div>Homicides - DDH ONU (410)</div>
        <div class="legend-item"><div class="legend-color" style="background:#9932CC"></div>Homicides - Other DDH (262)</div>
        <div class="legend-item"><div class="legend-color" style="background:#800080"></div>Massacres (490)</div>
    </div>
    <div class="info-panel">
        <h4>DATA SOURCE</h4>
        <p>ergit.presidencia.gov.co/server/rest/services</p>
        <p>Downloaded: January 5, 2026</p>
        <div class="stats-box">
            <strong>Actual Data Loaded:</strong><br>
            - Homicidios_layer0.json (1,822 records)<br>
            - Masacre_layer0.json (490 records)<br>
            <br>
            <strong>Total: 2,312 incidents</strong>
        </div>
        <p style="font-size:11px; color:#ffcccc;">
            Top Departments:<br>
            Cauca (340), Antioquia (253), Nari√±o (157)
        </p>
        <p style="color:#ff6b6b; font-size:11px;">NO AUTHENTICATION REQUIRED</p>
        <p style="font-size:10px; color:#888;">Click markers for details</p>
    </div>
    <div id="loading" class="loading">Loading 2,312 violence records...</div>

    <script>
        var map = L.map('map').setView([4.5, -74.0], 6);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap, &copy; CARTO',
            maxZoom: 18
        }).addTo(map);

        var homicideColors = {
            'FIRMANTE DEL ACUERDO DE PAZ': '#FF0000',
            'DDH - DEFENSORIA': '#FF8C00',
            'DDH- DEFENSORIA': '#FF8C00',
            'DDH - ONU': '#FFD700',
            'DDH - OTRAS PLATAFORMAS': '#9932CC',
            'DDH - PLATAFORMAS LOCALES': '#9932CC',
            'FAMILIAR': '#DC143C'
        };

        // Load homicide data
        fetch('homicides_data.json')
            .then(response => response.json())
            .then(homicides => {
                homicides.forEach(function(h) {
                    var color = homicideColors[h.victim] || '#FF0000';
                    L.circleMarker([h.lat, h.lng], {
                        radius: 5,
                        fillColor: color,
                        color: "#000",
                        weight: 1,
                        opacity: 1,
                        fillOpacity: 0.7
                    }).addTo(map)
                    .bindPopup("<b>HOMICIDIO</b><br>Dept: " + h.dept + "<br>Muni: " + h.muni +
                               "<br>Year: " + h.year + "<br>Gender: " + h.gender +
                               "<br>Category: " + h.victim);
                });
                console.log("Loaded " + homicides.length + " homicides");
            });

        // Load massacre data
        fetch('massacres_data.json')
            .then(response => response.json())
            .then(massacres => {
                massacres.forEach(function(m) {
                    L.circleMarker([m.lat, m.lng], {
                        radius: 8,
                        fillColor: "#800080",
                        color: "#fff",
                        weight: 2,
                        opacity: 1,
                        fillOpacity: 0.8
                    }).addTo(map)
                    .bindPopup("<b>MASACRE</b><br>Dept: " + m.dept + "<br>Muni: " + m.muni +
                               "<br>Date: " + m.date);
                });
                console.log("Loaded " + massacres.length + " massacres");
                document.getElementById('loading').style.display = 'none';
            });
    </script>
</body>
</html>
